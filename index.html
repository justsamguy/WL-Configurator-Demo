<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WoodLab Configurator Mockup</title>
  <!-- Tailwind CSS via CDN for rapid prototyping -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <!-- Google Fonts: Inter for modern look -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Custom styles -->
  <link rel="stylesheet" href="./css/configurator.css" />
</head>
<body class="bg-gray-50 text-gray-900 grid grid-rows-[auto_auto_1fr_auto] lg:grid-cols-[60fr_40fr] lg:grid-rows-[auto_auto_1fr_auto] h-screen overflow-hidden">
  <!-- App Header -->
  <header class="w-full flex items-center justify-between bg-white shadow px-8 py-3 sticky top-0 z-30 lg:col-span-2">
    <!-- Left: Menu -->
    <div class="flex items-center gap-2">
      <button aria-label="Open menu" class="btn btn-icon focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 rounded">
        <!-- Menu icon (Heroicons solid bars-3) -->
        <div class="icon-placeholder w-6 h-6 text-gray-700" data-icon="bars-3" data-icon-title="Main Menu"></div>
      </button>
      <span class="ml-1 text-sm text-gray-700 font-medium select-none">Menu</span>
    </div>
    <!-- Center: Logo -->
    <div class="flex-1 flex justify-center">
      <img src="assets/images/model1.svg" alt="WoodLab Logo" class="h-8 w-auto object-contain" />
    </div>
    <!-- Right: Utility Icons -->
    <div class="flex items-center gap-4">
      <button aria-label="Search" class="btn btn-icon focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 rounded">
        <!-- Search icon (Heroicons solid magnifying-glass) -->
        <div class="icon-placeholder w-6 h-6 text-gray-700" data-icon="magnifying-glass" data-icon-title="Search"></div>
      </button>
      <button aria-label="Account" class="btn btn-icon focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 rounded">
        <!-- User icon (Heroicons solid user) -->
        <div class="icon-placeholder w-6 h-6 text-gray-700" data-icon="user" data-icon-title="Account"></div>
      </button>
    </div>
  </header>
  <!-- Stage Bar -->
  <nav id="stage-bar" class="col-span-full row-span-1 w-full flex items-center justify-between bg-white shadow z-20 sticky top-0 lg:col-span-full lg:row-span-1 px-6 py-3">
    <div class="flex-1">
      <button id="prev-stage" class="nav-btn text-gray-400 opacity-40 cursor-default" disabled>< Previous</button>
    </div>
    <ol class="flex flex-row space-x-4">
      <li>
        <button class="stage-btn btn-tertiary" aria-current="step">Model</button>
      </li>
      <li>
        <button class="stage-btn btn-tertiary" disabled>Customize</button>
      </li>
      <li>
        <button class="stage-btn btn-tertiary" disabled>Summary</button>
      </li>
    </ol>
    <div class="flex-1 flex justify-end">
      <button id="next-stage" class="nav-btn">Next ></button>
    </div>
  </nav>

  <!-- Main Content - Viewer Section -->
  <main id="main-content" class="col-span-1 row-span-1 flex flex-col overflow-hidden lg:col-span-1 lg:row-span-1">
    <!-- 3D Viewer Section -->
    <section class="flex-1 flex flex-col items-center justify-center bg-white relative w-full p-4">
      <!-- 3D Viewer -->
      <div id="viewer" class="w-full h-full flex-1 flex flex-col items-center justify-center bg-gray-100 rounded-lg shadow-lg border border-gray-200">
        <div id="viewer-canvas" class="w-full h-full flex-1 flex items-center justify-center">
          <!-- Three.js canvas will be injected here -->
          <div id="viewer-placeholder" class="text-center text-gray-400 text-lg">
            Select a style to begin
          </div>
        </div>
      </div>
      <!-- Controls Bar - Moved outside viewer but below it -->
      <div id="viewer-controls-container" class="w-full mt-4 bg-white rounded-lg shadow-sm border border-gray-200">
        <!-- ViewerControls.html will be included here -->
        <div data-include="components/ViewerControls.html"></div>
      </div>
    </section>
  </main>

  <!-- Sidebar - Configuration Panel -->
  <aside id="sidebar" class="col-span-1 row-span-1 bg-white border-l flex flex-col overflow-y-auto shadow-lg lg:col-span-1 lg:row-span-1">
    <!-- Persistent Header -->
    <div class="flex flex-col gap-4 px-8 py-6 border-b bg-white sticky top-0 z-10">
      <div class="flex items-center justify-between">
        <div class="flex flex-col">
          <span class="text-xs text-gray-500">Total</span>
          <span id="price-bar" class="text-2xl font-bold" aria-live="polite" aria-atomic="true">$12,480 <span class="text-xs font-normal">USD</span></span>
        </div>
        <div class="flex items-center space-x-2">
          <button id="summary-btn" class="btn btn-icon tooltip" data-tip="Summary" aria-label="Summary">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="16" rx="2" stroke-width="2"/></svg>
          </button>
          <button id="help-btn" class="btn btn-icon tooltip" data-tip="Help" aria-label="Open help">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke-width="2"/><path d="M12 16v-4M12 8h.01" stroke-width="2"/></svg>
          </button>
        </div>
      </div>
      <!-- Model Selection (will be replaced by data-include) -->
      <div id="model-selection-placeholder"></div>
    </div>
    <!-- Stage Sections (populated by JS) -->
    <section id="stage1-section" class="p-8 flex-1 overflow-y-auto">
      <!-- Content for Stage 1 will be injected here -->
    </section>
    <section id="stage2-section" class="p-8 hidden flex-1 overflow-y-auto">
      <!-- Content for Stage 2 will be injected here -->
    </section>
    <section id="stage3-section" class="p-8 hidden flex-1 overflow-y-auto">
      <!-- Content for Stage 3 will be injected here -->
    </section>
    <!-- Help & Support -->
    <div class="mt-auto px-8 py-6 border-t bg-white">
      <h2 class="text-md font-semibold mb-2 cursor-pointer flex justify-between items-center" id="toggle-help-support">
        Help & Support
        <svg id="help-support-arrow" class="w-5 h-5 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
      </h2>
      <div id="sidebar-help-content" class="text-sm text-gray-600 hidden">
        <p class="mb-2">Need assistance with your configuration?</p>
        <button class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-1 px-3 rounded transition mb-2">View Help Guide</button>
        <p>Or contact us at <a href="mailto:support@woodlab.example.com" class="text-blue-600 hover:underline">support@woodlab.example.com</a></p>
      </div>
    </div>
  </aside>

  <!-- Bottom Summary Bar -->
  <footer class="col-span-full row-span-1 w-full bg-white border-t shadow fixed bottom-0 left-0 z-30 flex items-center justify-between px-12 py-4 max-h-20 lg:col-span-full lg:row-span-1">
    <div class="flex items-center gap-8">
      <span class="text-lg font-semibold">Total: <span id="footer-price" class="font-bold text-indigo-700">$12,480</span></span>
    </div>
    <button id="footer-next" class="btn btn-primary btn-lg">Next Step &rarr;</button>
  </footer>

  <!-- Banners -->
  <div id="banner-container" class="fixed top-0 left-0 w-full flex flex-col items-center space-y-2 z-50"></div>

  <!-- Help Drawer -->
  <aside id="help-drawer" class="fixed right-0 top-0 h-full w-[320px] bg-white shadow-lg z-50 transform translate-x-full transition-transform duration-300 ease-in-out" tabindex="-1" aria-hidden="true">
    <button id="help-close" class="btn btn-icon absolute top-2 left-2 text-gray-500" aria-label="Close help">
      <!-- Close icon (Heroicons solid x-mark) -->
      <div class="icon-placeholder w-6 h-6" data-icon="x-mark" data-icon-title="Close Help Drawer"></div>
    </button>
    <div class="p-6">
      <h2 class="text-xl font-bold mb-4">Help & Support</h2>
      <div id="help-content">
        <!-- Help content will be populated here -->
      </div>
    </div>
  </aside>
  <div id="help-backdrop" class="fixed inset-0 bg-black bg-opacity-30 z-40 hidden"></div>

  <!-- Scripts -->
  <!-- Three.js (CDN, UMD build for global THREE) -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  <!-- OrbitControls (CDN, UMD build for global THREE.OrbitControls) -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.min.js"></script>
  <!-- jsPDF and html2canvas (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.5.1/dist/html2canvas.min.js"></script>
  <!-- App scripts -->
  <script type="module" src="./js/main.js" defer></script>
  <script type="module" src="./js/app.js" defer></script>
  <script type="module" src="./js/viewer.js" defer></script>
  <script type="module" src="./js/ui/banner.js" defer></script>
  <script type="module" src="./js/ui/helpDrawer.js" defer></script>
  <script defer>
    // Keep footer price in sync with sidebar price
    document.addEventListener("statechange", () => {
      const priceBar = document.getElementById("price-bar");
      const footerPrice = document.getElementById("footer-price");
      if (priceBar && footerPrice) {
        footerPrice.textContent = priceBar.textContent.replace(/[^$\d,]/g, "");
      }
    });
    // Footer next button triggers next stage
    document.addEventListener("DOMContentLoaded", () => {
      const nextBtn = document.getElementById("footer-next");
      if (nextBtn) {
        nextBtn.addEventListener("click", () => {
          const nextStageBtn = document.getElementById("next-stage");
          if (nextStageBtn && !nextStageBtn.disabled) nextStageBtn.click();
        });
      }
    });
  </script>
</body>
</html>
